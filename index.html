<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Generate random PNG, JPEG, GIF, SVG or text files with exact size and dimensions">
  <meta name="keywords" content="image generator, text file generator, PNG size generator, random file generator">
  <meta name="author" content="CodexGPT">
  <title>Random File Generator (Exact Size)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5">
  <div class="card shadow-lg">
    <div class="card-body">
      <h3 class="card-title text-center mb-4">File Generator (Exact Size)</h3>
      <div class="mb-3">
        <label class="form-label">File Type:</label>
        <select id="fileType" class="form-select" onchange="toggleDimensions()">
          <option value="png">PNG</option>
          <option value="jpeg">JPEG</option>
          <option value="gif">GIF</option>
          <option value="svg">SVG</option>
          <option value="txt">TXT</option>
        </select>
      </div>
      <div class="mb-3" id="widthGroup">
        <label class="form-label">Width (px):</label>
        <input type="number" class="form-control" id="w" value="300">
      </div>
      <div class="mb-3" id="heightGroup">
        <label class="form-label">Height (px):</label>
        <input type="number" class="form-control" id="h" value="300">
      </div>
      <div class="mb-3">
        <label class="form-label">Target File Size (KB):</label>
        <input type="number" class="form-control" id="kb" value="300" max="2097152">
      </div>
      <div class="d-grid mb-3">
        <button onclick="generateFile()" class="btn btn-primary">Generate File</button>
      </div>
      <div class="progress" style="height: 20px;">
        <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
      </div>
      <p class="text-center mt-3" id="fileSizePreview"></p>
    </div>
  </div>
</div>

<script>
function toggleDimensions() {
  const fileType = document.getElementById("fileType").value;
  const isText = fileType === "txt";
  document.getElementById("widthGroup").style.display = isText ? "none" : "block";
  document.getElementById("heightGroup").style.display = isText ? "none" : "block";
}

toggleDimensions();

async function generateFile() {
  const fileType = document.getElementById("fileType").value;
  const width = parseInt(document.getElementById("w").value);
  const height = parseInt(document.getElementById("h").value);
  const sizeKBInput = parseInt(document.getElementById("kb").value);
  const progressBar = document.getElementById("progressBar");
  const fileSizePreview = document.getElementById("fileSizePreview");

  if (sizeKBInput > 2097152) {
    alert("Maximum allowed size is 2 GB (2097152 KB)");
    return;
  }

  const sizeKB = sizeKBInput * 1024;
  progressBar.style.width = '0%';
  progressBar.textContent = '0%';
  fileSizePreview.textContent = '';

  let data;
  let fileExt = fileType;

  if (["png", "jpeg", "gif"].includes(fileType)) {
    const canvas = document.createElement("canvas");
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext("2d");
    const imgData = ctx.createImageData(width, height);

    for (let i = 0; i < imgData.data.length; i += 4) {
      imgData.data[i] = Math.random() * 255;
      imgData.data[i+1] = Math.random() * 255;
      imgData.data[i+2] = Math.random() * 255;
      imgData.data[i+3] = 255;
    }

    ctx.putImageData(imgData, 0, 0);
    const blob = await new Promise(resolve => canvas.toBlob(resolve, `image/${fileType}`));
    data = new Uint8Array(await blob.arrayBuffer());

  } else if (fileType === "svg") {
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${width}' height='${height}'>\n<rect width='100%' height='100%' fill='rgb(${rand255()},${rand255()},${rand255()})'/></svg>`;
    data = new TextEncoder().encode(svg);

  } else if (fileType === "txt") {
    let content = '';
    while (content.length < sizeKB) content += Math.random().toString(36).substring(2);
    data = new TextEncoder().encode(content.substring(0, sizeKB));
  }

  if (data.length < sizeKB) {
    const padding = new Uint8Array(sizeKB - data.length).fill(0);
    const filled = new Uint8Array(sizeKB);
    filled.set(data);
    filled.set(padding, data.length);
    data = filled;
  }

  const blob = new Blob([data], { type: fileType.startsWith("text") ? "text/plain" : `image/${fileType}` });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `generated.${fileExt}`;
  a.click();
  URL.revokeObjectURL(url);

  progressBar.style.width = '100%';
  progressBar.textContent = '100%';
  fileSizePreview.textContent = `Generated file size: ${(data.length / 1024).toFixed(2)} KB`;
}

function rand255() {
  return Math.floor(Math.random() * 256);
}
</script>
</body>
</html>
